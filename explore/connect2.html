<html>
<head>
     <script type="text/javascript" src="https://accounts.google.com/gsi/client"></script>
     <script type="text/javascript" src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js"></script>

     <link rel="preconnect" href="https://fonts.googleapis.com">
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
     <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@100;200;300;400;500;600;700;800&display=swap" rel="stylesheet">
     <link href="../bringyour.com/res/css/bootstrap.min.css" rel="stylesheet">

     <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />

     <style>

          @font-face {
              font-family: 'Arkitech';
              src: url('res/fonts/Arkitech-Light.woff2') format('woff2'),
                  url('res/fonts/Arkitech-Light.woff') format('woff');
              font-weight: 300;
              font-style: normal;
              font-display: swap;
          }
          @font-face {
              font-family: 'Arkitech';
              src: url('res/fonts/Arkitech-Medium.woff2') format('woff2'),
                  url('res/fonts/Arkitech-Medium.woff') format('woff');
              font-weight: 500;
              font-style: normal;
              font-display: swap;
          }

          body {
               font-family: 'Noto Sans', sans-serif;
          }


          div.dialog {
               display: inline-block;
               border: 1px solid rgb(0, 0, 0);
               width: 600px;
               min-height: 400;
               padding: 12px;
               margin: 24px;
          }

          /*#appleid-signin svg text {
               font-family: sans-serif;
               font-size: 8pt;
          }
*/
          /*#appleid-signin {
               position: relative;
          }

          #appleid-signin div.signin-action {
               display: inline-block;
               position: relative;
               right: -100px;
          }*/



          div.login-separator {
               text-align: center;
          }

          div.login-option {
               margin-top: 12px;
               margin-bottom: 12px;
               text-align: center;
          }

          div.login-option div.login-container {
               display: inline-block;
               text-align: left;
               width: 300px;
          }

          #apple-container {
               display: inline-block;
               border: 1px solid rgb(218, 220, 224);
               border-radius: 4px;
               cursor: pointer;
               padding: 0px;
               transition: background-color .218s, border-color .218s;
               user-select: none;
          }

          #apple-container:hover {
/*             border-color: #d2e3fc*/
               border-color: rgb(0, 0, 0);
          }

          div.title {
               font-size: 18pt;
               font-weight: 200;
          }

          div.title span.material-symbols-outlined {
               font-size: 12pt;
               padding: 4px;
               color: rgb(0, 0, 0);
          }

          div.info-title {
               font-size: 12pt;
               font-weight: 100;
          }

          button span.primary {
               margin-left: 8px;
               margin-right: 8px;
          }

          

          /*#apple-container:active {
               background-color: rgb(250, 250, 250) !important;
          }

          #apple-container:active div {
               background-color: inherit !important;
          }*/

          input[type=text], input[type=password] {
               height: 39px;
               border: 1px solid rgb(218, 220, 224);
               border-radius: 4px;
               width: 300px;
          }

          textarea {
               height: 78px;
               border: 1px solid rgb(218, 220, 224);
               border-radius: 4px;
               width: 300px;
          }

          div.login-header {
               position: relative;
               margin-top: 12px;
               margin-bottom: 12px;
          }

          div.login-header div.header-right {
               position: absolute;
               bottom: 0px;
               right: 0px;
          }


          div.password-header {
               position: relative;
               margin-top: 4px;
               margin-bottom: 4px;
          }

          div.password-header div.header-right {
               position: absolute;
               bottom: 0px;
               right: 0px;
          }

          img.store {
               max-height: 40px;
          }
     </style>

     <script type="text/javascript">

          // parse current location to find the api

          const clientVersion = '';
          const googleClientId = 'data-client_id="338638865390-cg4m0t700mq9073smhn9do81mr640ig1.apps.googleusercontent.com'
          const appleClientId = 'com.bringyour.service'
          const authJwtRedirect = 'https://bringyour.com/connect'

          function serviceUrl(service, path) {
               let hostname = window.location.hostname
               // <env>-<service>.bringyour.com or <service>.bringyour.com
               // if service == lb, 
               //    if /sb/<serviceblock> and serviceblock == beta
               //      use /sb/<service>/beta
               //    else, use /by/<service>
               // else, use <env>-<service> or <service>

               // local-api.bringyour.com

          }

          function userAuthType(userAuth) {
               if (userAuth.startsWith('+')) {
                    return 'phone'
               }
               else if (userAuth.includes('@')) {
                    return 'email'
               }
               return 'unknown'
          }


          function Route(path, component) {
               this.path = path
               this.component = component
          }

          const topLevelRoutes = [
               new Route('/connect', new DialogInitial()),
               new Route('/connect/create', new DialogCreateNetwork()),
          ]

          function Mount(container) {
               const self = this
               self.activeComponent = null

               this.render = (component) => {
                    self.activeComponent = component
                    // FIXME if component is undefined, check the query params for oauth jwts
                    // use <api>/auth/login  jwt=X
                    component.mount = self
                    component.render(container)
               }

               

               // approach inspired by https://bholmes.dev/blog/spas-clientside-routing/
               this.router = () => {
                    function findLink(e) {
                         let linkElement = null
                         while (e) {
                              if (container == e) {
                                   return linkElement
                              }
                              if (e.tagName === 'A') {
                                   linkElement = e
                              }
                              e = e.parentElement
                         }
                         return null
                    }
                    container.addEventListener('click', (event) => {
                         const linkElement = findLink(event.target)
                         // a link of same origin with no target (new tab)
                         if (
                              linkElement &&
                              linkElement.origin === location.origin &&
                              !linkElement.target
                         ) {
                              event.preventDefault()
                              const url = new URL(linkElement.href)
                              let handled = false
                              for (const route of topLevelRoutes) {
                                   if (url.pathname == route.path) {
                                        self.render(route.component)
                                        handled = true
                                        break
                                   }
                              }
                              if (!handled && self.activeComponent) {
                                   self.activeComponent.router(url)
                              }
                         }
                    })
               }
          }


          function DialogInitial() {
               const self = this
               this.render = (container) => {
                    renderInitial(container)

                    const nonce = crypto.randomUUID()

                    // connect with apple
                    AppleID.auth.init({
                         clientId : appleClientId,
                         scope : 'name email',
                         redirectURI : authJwtRedirect,
                         state : 'continue',
                         nonce : nonce,
                         usePopup : true
                    });
                    document.addEventListener('AppleIDSignInOnSuccess', function(data) {
                         // fixme
                         alert('Apple auth')
                    });
                    document.addEventListener('AppleIDSignInOnFailure', (event) => {
                         // fixme
                         alert('Apple auth failure')
                    });

                    // connect with google
                    window.google.accounts.id.initialize({
                         client_id: googleClientId,
                         callback: (res, error) => {
                              // fixme
                              alert('Google auth')
                         },
                    });
                    google.accounts.id.prompt();
                    window.google.accounts.id.renderButton(document.getElementById('g_id_button'), {
                         type: 'standard',
                         theme: 'outline',
                         size: 'large',
                         text: 'continue_with',
                         shape: 'rectangular',
                         logo_alignment: 'center',
                         width: 300
                    });

                    document.getElementById('login-button').addEventListener("click", (event) => {
                         self.submit()
                    })

                    document.getElementById("login-form").addEventListener("submit", (event) => {
                         event.preventDefault()
                         self.submit()
                    })
               }
               this.router = (url) => {

               }


               // event handlers

               this.submit = () => {
                    const loginUserAuthElement = document.getElementById('login-user-auth')
                    const loginButtonElement = document.getElementById('login-button') 
                    const loginSpinnerElement = document.getElementById('login-form-spinner')

                    loginUserAuthElement.disabled = true
                    loginButtonElement.disabled = true
                    loginSpinnerElement.classList.remove('visually-hidden')

                    let userAuth = loginUserAuthElement.value
                    let requestBody = {
                         userAuth: userAuth
                    }

                    setTimeout(() => {
                         let responseBody = MOCK_API_auth_login(requestBody)
                         self.handleSubmitResponse(responseBody)
                    }, 1000);
               }

               this.handleSubmitResponse = (responseBody) => {
                    const loginUserAuthElement = document.getElementById('login-user-auth')
                    const loginButtonElement = document.getElementById('login-button') 
                    const loginSpinnerElement = document.getElementById('login-form-spinner')

                    let userAuth = loginUserAuthElement.value

                    if ('error' in responseBody) {
                         let error = responseBody['error']
                         let suggestedUserAuth = error['suggestedUserAuth'] || userAuth
                         let message = error['message']

                         let errorElement = document.getElementById('login-error')
                         errorElement.textContent = message
                         errorElement.classList.remove('visually-hidden')

                         loginUserAuthElement.value = suggestedUserAuth

                         loginUserAuthElement.disabled = false
                         loginButtonElement.disabled = false
                         loginSpinnerElement.classList.add('visually-hidden')
                    }
                    else if ('loginSessionId' in responseBody) {
                         // an existing network
                         userAuth = responseBody['userAuth'] || userAuth
                         let authAllowed = responseBody['authAllowed']
                         if (authAllowed.includes('password')) {
                              let loginSessionId = responseBody['loginSessionId']
                              self.mount.render(new DialogLoginPassword(userAuth, loginSessionId))
                         } else {
                              let message
                              if (authAllowed.includes('apple') && authAllowed.includes('google')) {
                                   message = 'Please login with Apple or Google'
                              }
                              else if (authAllowed.includes('apple')) {
                                   message = 'Please login with Apple'
                              }
                              else if (authAllowed.includes('google')) {
                                   message = 'Please login with Google'
                              } else {
                                   message = 'Something went wrong. Please try again later.'
                              }
                              let errorElement = document.getElementById('login-error')
                              errorElement.textContent = message
                              errorElement.classList.remove('visually-hidden')

                              loginUserAuthElement.disabled = false
                              loginButtonElement.disabled = false
                              loginSpinnerElement.classList.add('visually-hidden')
                         }
                    }
                    else {
                         // a new network
                         userAuth = responseBody['userAuth'] || userAuth
                         self.mount.render(new DialogCreateNetwork(userAuth))
                    }
               }
          }

          function DialogLoginPassword(userAuth, loginSessionId) {
               const self = this
               this.render = (container) => {
                    renderLoginPassword(container, userAuth)

                    document.getElementById('login-button').addEventListener("click", (event) => {
                         self.submit()
                    })

                    document.getElementById("login-form").addEventListener("submit", (event) => {
                         event.preventDefault()
                         self.submit()
                    })
               }
               this.router = (url) => {
               }


               // event handlers

               this.submit = () => {
                    const loginPasswordElement = document.getElementById('login-password')
                    const loginButtonElement = document.getElementById('login-button') 
                    const loginSpinnerElement = document.getElementById('login-form-spinner')

                    loginPasswordElement.disabled = true
                    loginButtonElement.disabled = true
                    loginSpinnerElement.classList.remove('visually-hidden')

                    let password = loginPasswordElement.value
                    let requestBody = {
                         loginSessionId: loginSessionId,
                         password: password
                    }

                    setTimeout(() => {
                         let responseBody = MOCK_API_auth_login_password(requestBody)
                         self.handleSubmitResponse(responseBody)
                    }, 1000);
               }

               this.handleSubmitResponse = (responseBody) => {
                    const loginPasswordElement = document.getElementById('login-password')
                    const loginButtonElement = document.getElementById('login-button') 
                    const loginSpinnerElement = document.getElementById('login-form-spinner')

                    if ('error' in responseBody) {
                         let error = responseBody['error']
                         let message = error['message']

                         let errorElement = document.getElementById('login-error')
                         errorElement.textContent = message
                         errorElement.classList.remove('visually-hidden')

                         loginPasswordElement.disabled = false
                         loginButtonElement.disabled = false
                         loginSpinnerElement.classList.add('visually-hidden')
                    }
                    else if ('validationRequired' in responseBody) {
                         let validationRequired = responseBody['validationRequired']
                         let validationUserAuth = validationRequired['userAuth']

                         self.mount.render(new DialogCreateNetworkValidate(validationUserAuth, loginSessionId))
                    }
                    else if ('network' in responseBody) {
                         let network = responseBody['network']
                         let networkName = network['name']

                         self.mount.render(new DialogComplete(networkName))
                    } else {
                         let message = 'Something went wrong. Please try again later.'

                         let errorElement = document.getElementById('login-error')
                         errorElement.textContent = message
                         errorElement.classList.remove('visually-hidden')

                         loginUserAuthElement.disabled = false
                         loginButtonElement.disabled = false
                         loginSpinnerElement.classList.add('visually-hidden')
                    }
               }
          }

          

          function DialogPasswordReset(userAuth) {
               const self = this
               this.render = (container) => {
                    renderPasswordReset(container, userAuth)
               }
               this.router = (url) => {
                    
               }
          }


          function DialogPasswordResetAfterSend(userAuth) {
               const self = this
               this.render = (container) => {
                    renderPasswordResetAfterSend(container, userAuth)
               }
               this.router = (url) => {
                    
               }
          }


          function DialogPasswordResetComplete(resetCode) {
               const self = this
               this.render = (container) => {
                    renderPasswordResetComplete(container, resetCode)
               }
               this.router = (url) => {
                    
               }
          }


          function DialogCreateNetworkAuthJwt(authJwt) {
               const self = this
               this.render = (container) => {
                    renderCreateNetworkAuthJwt(container, authJwt)
               }
               this.router = (url) => {
                    
               }
          }


          function DialogCreateNetwork(userAuth) {
               const self = this
               this.render = (container) => {
                    renderCreateNetwork(container, userAuth)
               }
               this.router = (url) => {
                    if ('/connect/reset' == url.pathname) {
                         const userAuth = document.getElementById('create-user-auth').value
                         self.mount.render(new DialogPasswordReset(userAuth))
                    }
               }
          }


          function DialogCreateNetworkValidate(userAuth) {
               const self = this
               this.render = (container) => {
                    renderCreateNetworkValidate(container, userAuth)
               }
               this.router = (url) => {
               }
          }


          function DialogComplete(networkName) {
               const self = this
               this.render = (container) => {
                    renderComplete(container, networkName)
               }
               this.router = (url) => {
               }
          }




          function renderInitial(container) {
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title">Login</div><div class="header-right"><a href="/connect/create">or create a network</a></div>
                              </div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div id="g_id_onload"
                                   data-client_id="${googleClientId}"
                                   data-context="signin"
                                   data-ux_mode="popup"
                                   data-login_uri="${authJwtRedirect}"
                                   data-nonce=""
                                   data-auto_select="true"
                                   data-itp_support="true"
                                   data-width="300"
                                   data-height="39"></div>

                              <div id="g_id_button" class="g_id_signin"
                                   data-type="standard"
                                   data-shape="rectangular"
                                   data-theme="outline"
                                   data-text="continue_with"
                                   data-size="large"
                                   data-logo_alignment="center"
                                   data-width="300"
                                   data-height="39">
                              </div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div id="apple-container">
                                   <div id="appleid-signin"
                                        data-color="white"
                                        data-border="false"
                                        data-type="continue"
                                        data-mode="center-align"
                                        data-logo-size="large"
                                        data-width="300"
                                        data-height="39"></div>
                                   </div>
                         </div>
                    </div>
                    <div class="login-separator">- or -</div>
                    <div class="login-option">
                         <div class="login-container">
                              <form id="login-form">
                                   <div class="info-title">Email or Phone Number</div>
                                   <div><input id="login-user-auth" type="text"/></div>
                                   <div id="login-error" class="text-danger visually-hidden"></div>
                                   <div><button id="login-button" class="btn btn-primary" type="button"><span id="login-form-spinner" class="spinner-border spinner-border-sm visually-hidden" role="status" aria-hidden="true"></span><span class="primary">Continue</span></button></div>
                              </form>
                         </div>
                    </div>
               `
               container.innerHTML = html


          }

          function renderLoginPassword(container, userAuth) {
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title"><a href="/connect"><span class="material-symbols-outlined">arrow_back_ios_new</span></a>Welcome back</div></div>
                              <div>Log in using ${userAuth}</div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <form id="login-form">
                                   <div class="password-header"><div class="info-title">Password</div><div class="header-right"><a href="">Forgot your password?</a></div></div>
                                   <div><input id="login-password" type="password"/></div>
                                   <div id="login-error" class="text-danger visually-hidden">Invalid email or password</div>
                                   <div><button id="login-button" class="btn btn-primary" type="button"><span id="login-form-spinner" class="spinner-border spinner-border-sm visually-hidden" role="status" aria-hidden="true"></span><span class="primary">Continue</span></button></div>
                              </form>
                         </div>
                    </div>
               `

               container.innerHTML = html

          }

          function renderPasswordReset(container, userAuth) {
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title"><a href="/connect"><span class="material-symbols-outlined">arrow_back_ios_new</span></a>Forgot your password?</div></div>
                              <div>Enter your email or phone number to reset your password.</div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div class="info-title">Email or Phone Number</div>
                              <div><input type="text" value="${userAuth}"/></div>
                              <div><input type="button" value="Submit"></div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div>You may need to check your spam folder or unblock no-reply@bringyour.com</div>
                         </div>
                    </div>
               `

               container.innerHTML = html
          }

          function renderPasswordResetAfterSend(container, userAuth) {
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title"><a href="/connect"><span class="material-symbols-outlined">arrow_back_ios_new</span></a>Forgot your password?</div></div>
                              <div>Reset link sent to ${userAuth}</div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div>You may need to check your spam folder or unblock no-reply@bringyour.com</div>
                              <div><a href="">Resend</a></div>
                         </div>
                    </div>
               `

               container.innerHTML = html
          }

          function renderPasswordResetComplete(container, resetCode) {
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title">Reset your password</div></div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div class="info-title">New Password</div>
                              <div><input type="password"/></div>
                              <div class="info-title">Re-enter New Password</div>
                              <div><input type="password"/></div>
                              <div><input type="button" value="Submit"></div>
                         </div>
                    </div>
               `

               container.innerHTML = html
          }

          function renderCreateNetworkAuthJwt(container, authJwt) {
               let jwtType = 'Apple'
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title"><a href="/connect"><span class="material-symbols-outlined">arrow_back_ios_new</span></a>Create a network</div></div>
                              <div>${jwtType} will be the primary login.</div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div class="info-title">Your Name</div>
                              <div><input type="text"></div>
                              <div class="info-title">Choose a network name</div>
                              <div><input type="text"/>.bringyour.network</div>
                              <div><label><input type="checkbox" value="">I agree to the <a href="/terms.html" target="_blank">BringYour terms</a>. Learn about how we use and protect your data in our <a href="">Privacy Policy</a></label></div>
                              <div><input type="button" value="Create Network"></div>
                         </div>
                    </div>
               `

               container.innerHTML = html
          }

          function renderCreateNetwork(container, userAuth) {
               let userAuthStr = userAuth ? userAuth : ''
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title"><a href="/connect"><span class="material-symbols-outlined">arrow_back_ios_new</span></a>Create a network</div></div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div class="info-title">Your Name</div>
                              <div><input type="text"></div>
                              <div class="info-title">Email or Phone Number</div>
                              <div><input id="create-user-auth" type="text" value="${userAuthStr}"></div>
                              <div id="create-error" class="text-danger">This email or phone number is already taken. <a href="/connect">Sign in</a> or <a href="/connect/reset">reset your password</a>.</div>
                              <div class="info-title">Password</div>
                              <div><input type="password"/></div>
                              <div class="info-title">Choose a network name</div>
                              <div><input type="text"/>.bringyour.network</div>
                              <div><label><input type="checkbox" value="">I agree to the <a href="/terms.html" target="_blank">BringYour terms</a>. Learn about how we use and protect your data in our <a href="">Privacy Policy</a></label></div>
                              <div><input type="button" value="Create Network"></div>
                         </div>
                    </div>
               `

               container.innerHTML = html
          }

          function renderCreateNetworkValidate(container, userAuth) {
               let title
               if (userAuthType(userAuth) == 'email') {
                    title = 'Validate your email'
               }
               else if (userAuthType(userAuth) == 'phone') {
                    title = 'Validate your phone number'
               }
               else {
                    title = 'Validate your email or phone number'
               }
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title"><a href="/connect"><span class="material-symbols-outlined">arrow_back_ios_new</span></a>${title}</div></div>
                              <div>We sent a code to ${userAuth}. Please enter it below.</div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div class="password-header"><div class="info-title">Code</div><div class="header-right"><a href="">Resend</a></div></div>
                              <div><input type="text"></div>
                              <div id="validate-error" class="text-danger">Invalid code</div>
                              <div><input type="button" value="Continue"></div>
                         </div>
                    </div>
               `

               container.innerHTML = html
          }

          function renderComplete(container, networkName) {
               let html = `
                    <div class="login-option">
                         <div class="login-container">
                              <div class="login-header"><div class="title">${networkName}.bringyour.network</div></div>
                              <div>Log in to the app to use your network.</div>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <img src="../bringyour.com/res/images/store-play.png" class="store">
                         </div>
                         <div class="login-container">
                              <img src="../bringyour.com/res/images/store-app.svg" class="store">
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <label><input type="checkbox" value=""> You can send me occasional product updates</label>
                         </div>
                    </div>
                    <div class="login-option">
                         <div class="login-container">
                              <div class="title">Can you take a minute to give us some feedback?</div>
                              <div>I use my network for 
                                   <div><label><input type="checkbox" value=""> Personal</label></div>
                                   <div><label><input type="checkbox" value=""> Business</label></div>
                              </div>
                              <div>The following use cases are valuable to me 
                                   <div><label><input type="checkbox" value=""> Stay anonymous and private on the internet</label></div>
                                   <div><label><input type="checkbox" value=""> Have verified safe internet everywhere</label></div>
                                   <div><label><input type="checkbox" value=""> Access regional and international networks</label></div>
                                   <div><label><input type="checkbox" value=""> Connect with my homes, friends and family</label></div>
                                   <div><label><input type="checkbox" value=""> Control the use of data and apps on my network</label></div>
                                   <div><label><input type="checkbox" value=""> Block ads</label></div>
                                   <div><label><input type="checkbox" value=""> Block personal data collection parties</label></div>
                                   <div><label><input type="checkbox" value=""> Help stay focused by temporarily blocking overused sites and content</label></div>
                                   <div><label><input type="checkbox" value=""> Access private servers from anywhere</label></div>
                                   <div><label><input type="checkbox" value=""> Run custom code and servers</label></div>
                                   <div><label><input type="checkbox" value=""> Prevent cyber attacks like phishing</label></div>
                                   <div><label><input type="checkbox" value=""> Audit usage of my network for compliance</label></div>
                                   <div><label><input type="checkbox" value=""> Implement a zero-trust or secure business environment</label></div>
                                   <div><label><input type="checkbox" value=""> Visualize and understand my network data</label></div>
                              </div>
                              <div>What do you want to do with your network?</div>
                              <div><textarea></textarea></div>
                              <div><input type="button" value="Submit"></div>
                         </div>
                    </div>
               `

               container.innerHTML = html
          }


          // API mocks

          function MOCK_API_auth_login(requestBody) {
               let userAuth = requestBody['userAuth']

               // loginSessionId, userAuth, authAllowed=[], error={suggestedUserAuth, message}
               let responseBody
               if (userAuth == 'xcolwell@gmail.com') {
                    responseBody = {
                         loginSessionId: crypto.randomUUID(),
                         userAuth: 'xcolwell@gmail.com',
                         authAllowed: ['apple']
                    }
               }
               else if (userAuth == 'brien@bringyour.com') {
                    responseBody = {
                         userAuth: 'brien@bringyour.com',
                         authAllowed: ['password', 'apple', 'google']
                    }
               }
               else if (userAuth == '5103408248') {
                    responseBody = {
                         loginSessionId: crypto.randomUUID(),
                         userAuth: '+1 510-340-8248',
                         authAllowed: ['password']
                    }
               }
               else if (userAuth == '510') {
                    responseBody = {
                         error: {
                              suggestedUserAuth: '+1 510',
                              message: 'A full phone phone number with +x country code required. It looks like your country code is +1.'
                         }
                    }
               }
               else if (userAuth == 'xcolwell') {
                    responseBody = {
                         error: {
                              suggestedUserAuth: 'xcolwell@',
                              message: 'Invalid email.'
                         }
                    }
               } else {
                    responseBody = {
                         error: {
                              message: 'Invalid email or phone number.'
                         }
                    }
               }

               return responseBody
          }


          function MOCK_API_auth_login_password(requestBody) {
               let loginSessionId = requestBody['loginSessionId']
               let password = requestBody['password']

               // loginSessionId, validationRequired={userAuth}, network={name}, error={message}
               let responseBody
               if (password == 'test') {
                    responseBody = {
                         loginSessionId: loginSessionId,
                         network: {
                              name: 'brien'
                         }
                    }
               }
               else if (password == 'test2') {
                    responseBody = {
                         loginSessionId: loginSessionId,
                         validationRequired: {
                              userAuth: '+1 510-340-8248'
                         }
                    }
               }
               else {
                    responseBody = {
                         loginSessionId: loginSessionId,
                         error: {
                              message: 'Invalid user or password.'
                         }
                    }
               }

               return responseBody
          }



     </script>
</head>
<body>
     <h2>Initial</h2>
     <div class="dialog" id="dialog-initial">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-initial'))
                    mount.render(new DialogInitial())
                    mount.router()
               })()
          </script>
     </div>

     <h2>Initial, Password</h2>
     <div class="dialog" id="dialog-login-password">
          <script type="text/javascript">
               // fixme id overlap
               // (() => {
               //      let mount = new Mount(document.getElementById('dialog-login-password'))
               //      mount.render(new DialogLoginPassword('+1 510-340-8248'))
               // })()
          </script>
     </div>

     <h2>Forgot password</h2>
     <div class="dialog" id="dialog-password-reset">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-password-reset'))
                    mount.render(new DialogPasswordReset('+1 510-340-8248'))
               })()
          </script>
     </div>

     <h2>Forgot password, after send</h2>
     <div class="dialog" id="dialog-password-reset-after-send">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-password-reset-after-send'))
                    mount.render(new DialogPasswordResetAfterSend('+1 510-340-8248'))
               })()
          </script>
     </div>

     <h2>Forgot password, reset link landing</h2>
     <div class="dialog" id="dialog-password-reset-complete">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-password-reset-complete'))
                    mount.render(new DialogPasswordResetComplete('aresetcode'))
               })()
          </script>

     </div>

     <h2>Continue with Google or Apple, No Network</h2>
     <div class="dialog" id="dialog-create-network-auth-jwt">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-create-network-auth-jwt'))
                    mount.render(new DialogCreateNetworkAuthJwt('authjwt'))
               })()
          </script>

     </div>

     <h2>Create network</h2>
     <div class="dialog" id="dialog-create-network">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-create-network'))
                    mount.render(new DialogCreateNetwork('+1 510-340-8248'))
               })()

          </script>
     </div>

     <h2>Continue with Email or SMS, No Network, Validate</h2>
     <div class="dialog" id="dialog-create-network-validate">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-create-network-validate'))
                    mount.render(new DialogCreateNetworkValidate('+1 510-340-8248'))
               })()

          </script>
     </div>

     <h2>Complete</h2>
     <div class="dialog" id="dialog-complete">
          <script type="text/javascript">
               (() => {
                    let mount = new Mount(document.getElementById('dialog-complete'))
                    mount.render(new DialogComplete('brien'))
               })()
          </script>
     </div>

</body>
</html>
